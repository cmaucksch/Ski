<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Ski Tracker</title>
<style>
    body {
        font-family: sans-serif;
        padding: 20px;
        background: #f5f5f5;
    }
    .ski-row {
        display: flex;
        align-items: center;
        margin-bottom: 15px;
    }
    .ski-box {
        width: 120px;
        height: 50px;
        border-radius: 8px;
        border: 1px solid #aaa;
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
        margin-right: 10px;
        background: white;
        font-size: 22px;
        font-weight: bold;
        color: black;
    }
    .reset-btn {
        position: absolute;
        top: -8px;
        right: -8px;
        background: #d32f2f;
        color: white;
        width: 22px;
        height: 22px;
        border-radius: 50%;
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 14px;
        cursor: pointer;
        user-select: none;
    }
    button {
        padding: 10px 15px;
        margin-right: 10px;
        border: none;
        border-radius: 8px;
        font-size: 16px;
        cursor: pointer;
    }
    .plus-btn {
        background: #4caf50;
        color: white;
    }
    .service-btn {
        background: #1565c0;
        color: white;
    }
</style>
</head>
<body>

<h2>Ski Tracker</h2>

<div id="container"></div>

<script>
// --- SKI LISTE ---
let skis = ["SL1", "SL2", "GS1", "GS2"];

// --- FARBCODES ---
const colors = ["white", "lightgreen", "yellow", "orange", "red"];

// --- LOAD ---
function loadData() {
    const data = localStorage.getItem("skiData");
    const list = localStorage.getItem("skiList");

    return {
        data: data ? JSON.parse(data) : {},
        list: list ? JSON.parse(list) : skis
    };
}

// --- SAVE ---
function saveData(dataObj) {
    localStorage.setItem("skiData", JSON.stringify(dataObj.data));
    localStorage.setItem("skiList", JSON.stringify(dataObj.list));
}

// --- UI ---
function createUI() {
    const container = document.getElementById("container");
    container.innerHTML = "";

    const state = loadData();
    const data = state.data;
    skis = state.list;

    skis.forEach(name => {
        if (!data[name]) data[name] = { count: 0, colorIndex: 0 };

        const row = document.createElement("div");
        row.className = "ski-row";

        const box = document.createElement("div");
        box.className = "ski-box";
        box.style.background = colors[data[name].colorIndex];
        box.textContent = name + " (" + data[name].count + ")";

        // --- X BUTTON (löscht Ski aus der Liste) ---
        const resetX = document.createElement("div");
        resetX.className = "reset-btn";
        resetX.textContent = "x";

        resetX.onclick = () => {
            // Entfernen aus Liste + Daten löschen
            const idx = skis.indexOf(name);
            if (idx >= 0) skis.splice(idx, 1);
            delete data[name];

            saveData({ data, list: skis });
            createUI();
        };

        box.appendChild(resetX);

        // --- + Button ---
        const plusBtn = document.createElement("button");
        plusBtn.className = "plus-btn";
        plusBtn.textContent = "+";

        plusBtn.onclick = () => {
            data[name].count += 1;
            data[name].colorIndex = Math.min(data[name].count, 4);
            saveData({ data, list: skis });
            createUI();
        };

        // --- SERVICE Button (Farbe weiß, Zähler bleibt) ---
        const serviceBtn = document.createElement("button");
        serviceBtn.className = "service-btn";
        serviceBtn.textContent = "Service";

        serviceBtn.onclick = () => {
            data[name].colorIndex = 0;
            saveData({ data, list: skis });
            createUI();
        };

        row.appendChild(box);
        row.appendChild(plusBtn);
        row.appendChild(serviceBtn);
        container.appendChild(row);
    });

    saveData({ data, list: skis });
}

createUI();
</script>

</body>
</html>
